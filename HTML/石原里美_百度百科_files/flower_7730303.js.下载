define("wiki-lemma:widget/lemma_content/configModule/shushuo/shushuoRank/flower",function(n,e,o){var i=n("wiki-common:widget/lib/jquery/jquery"),t=n("wiki-common:widget/component/nslog/nslog"),a=n("wiki-common:widget/util/loadXaf"),r=n("wiki-common:widget/component/userLogin/userLogin"),l=function(n){var e=n,o=[],l=null,s=!1;this.getRank=function(){s||(s=!0,i.getJSON("/starflower/api/starflowerrank",{lemmaid:e.lemmaId},function(n){if(n&&0==n.errno){n.isLogin&&a.init({dataApp:"eyJhcHBfa2V5IjoiNTIxOCIsImFwcF92aWV3IjoicHJvbW90ZSIsImZvcm1fZGVzYyI6IiIsInNlbmRfaW50ZXJ2YWwiOjUwLCJzZW5kX21ldGhvZCI6MywiYnJvd3Nlcl91cmwiOiJodHRwczovL3NvZmlyZS5iYWlkdS5jb20vZGF0YS91YS9hYi5qc29uIn0=",initParams:{ak:5218,aid:5218}}),l=n.tk;for(var e=0;e<o.length;e++)!!o[e].handleRankSuccess&&o[e].handleRankSuccess(n)}else for(var e=0;e<o.length;e++)!!o[e].handleRankError&&o[e].handleRankError(n);s=!1}))},this.vote=function(){var n=a.getVwAndTk();i.getJSON("/starflower/api/starflowervote",{lemmaid:e.lemmaId,tk:l,to:n.to,vw:n.vw},function(n){if(n&&4===n.errno)for(var e=0;e<o.length;e++)!!o[e].handleVoteFail&&o[e].handleVoteFail(n);if(n&&0==n.errno){t(10001704);for(var e=0;e<o.length;e++)!!o[e].handleVoteSuccess&&o[e].handleVoteSuccess(n)}else{n&&3==n.errno&&r.showLoginPop();for(var e=0;e<o.length;e++)!!o[e].handleVoteError&&o[e].handleVoteError(n)}})},this.regist=function(n){o.push(n)}};l._instance=null,l.getInstance=function(n){return l._instance||(l._instance=new l(n)),l._instance},o.exports=l});